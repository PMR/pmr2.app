<html xmlns="http://www.w3.org/1999/xhtml"
    tal:define="
      ajax_load request/ajax_load | nothing;
    ">
  <body>

    <div tal:replace="structure provider:pmr2.app.above_content_body_portlets"
        tal:condition="not:ajax_load">
    </div>

    <h3>Workspace Summary</h3>
    <dl>

      <tal:if tal:condition="view/description">
        <dt>Description</dt>
        <dd tal:content="view/description"/>
      </tal:if>

      <dt>Owner</dt>
      <dd><span tal:replace="structure view/owner"/></dd>

      <dt>URI for <span tal:omit-tag="not:nothing" tal:content="context/storage" 
        /> clone/pull/push</dt>
      <dd><a href="" 
          tal:attributes="href context/absolute_url"
          tal:content="context/absolute_url"></a></dd>

    </dl>

    <h4>Files</h4>

    <div tal:content="structure context/@@file/call_template"/>

    <script type="text/javascript">
      openhref = function(e) {
          e.preventDefault();
          window.location = $(context.active.target).attr('href');
      }

      opendata = function(e) {
          e.preventDefault();
          window.location = $(context.active.target).attr('data-src');
      },

      $(document).ready(function () {
          context.init({
              fadeSpeed: 100,
              filter: function ($obj){},
              above: 'auto',
              preventDoubleContext: true,
              compress: false
          });

          context.attach('.wsfmenu.open a', [
              {text: 'Open', action: openhref},
          ]);

          context.attach('.wsfmenu.download a', [
              {text: 'Open', action: openhref},
              {text: 'Download', action: opendata}
          ]);

      });

    </script>

  </body>
</html>
